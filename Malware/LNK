rule lnk_wiped {
    meta:
      author="gvenere"
      description="LNK with wiped metadata"
 
    strings:
        $lnk_magic = { 4c 00 00 00 }
        $ext1 = ".js"  // additional strings to search
        $ext2 = ".bat" // in the LNK target area
        $ext3 = ".cmd" // These are for Qakbot
 
 
    condition:
        $lnk_magic at 0x0 and
        uint16(0x1c) == 0x0 and // CreationTime == 0x0
        uint16(0x24) == 0x0 and // AccessTime == 0x0
        uint16(0x2c) == 0x0 and // WriteTime == 0x0
        // To target specific families we can add additional checks here
        ( any of ($ext*) in (0xa0..0x100) )
}
